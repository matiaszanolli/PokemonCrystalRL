<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon Crystal RL - Unified Training Dashboard</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="header">
        <h1>üéÆ Pokemon Crystal RL Training Dashboard</h1>
        <div class="subtitle">
            Advanced reinforcement learning with local LLM decision making and real-time monitoring
            <span id="connection-status" class="status-indicator connected">üü¢ Connected</span>
        </div>
    </div>

    <div class="grid-container">
        <!-- Training Statistics Panel -->
        <div class="panel">
            <h2>üìä Training Statistics</h2>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">TOTAL ACTIONS</div>
                    <div class="stat-value" id="total-actions">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">ACTIONS/SECOND</div>
                    <div class="stat-value" id="actions-per-second">0.0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">LLM DECISIONS</div>
                    <div class="stat-value" id="llm-decisions">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">TOTAL REWARD</div>
                    <div class="stat-value" id="total-reward">0.0</div>
                </div>
            </div>
        </div>

        <!-- Live Game Screen Panel -->
        <div class="panel game-screen-panel">
            <h2>üéØ Live Game Screen</h2>
            <div class="game-screen">
                <img id="game-screen" alt="Game screen" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==">
                <div id="screen-status" class="screen-status">Waiting for game data...</div>
            </div>
        </div>

        <!-- Game State Panel -->
        <div class="panel">
            <h2>üé≤ Game State</h2>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">MAP</div>
                    <div class="stat-value" id="current-map">-</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">POSITION</div>
                    <div class="stat-value" id="player-position">0,0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">MONEY</div>
                    <div class="stat-value" id="player-money">¬•0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">BADGES</div>
                    <div class="stat-value" id="player-badges">0/16</div>
                </div>
            </div>
        </div>

        <!-- Recent LLM Decisions Panel -->
        <div class="panel">
            <h2>ü§ñ Recent LLM Decisions</h2>
            <div id="llm-decisions-container" class="decisions-container">
                <div class="no-data">No LLM decisions yet...</div>
            </div>
        </div>

        <!-- Live Memory Debug Panel -->
        <div class="panel memory-debug-panel">
            <h2>üîç Live Memory Debug</h2>
            <div id="memory-debug-container" class="debug-container">
                <div class="no-data">Loading memory data...</div>
            </div>
        </div>

        <!-- System Status Panel -->
        <div class="panel">
            <h2>‚öôÔ∏è System Status</h2>
            <div class="status-grid">
                <div class="status-item">
                    <span class="status-label">Training Active:</span>
                    <span id="training-active" class="status-value">Unknown</span>
                </div>
                <div class="status-item">
                    <span class="status-label">WebSocket Connections:</span>
                    <span id="websocket-connections" class="status-value">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Last Update:</span>
                    <span id="last-update" class="status-value">Never</span>
                </div>
                <div class="status-item">
                    <span class="status-label">API Status:</span>
                    <span id="api-status" class="status-value">Checking...</span>
                </div>
            </div>
        </div>

        <!-- Training Visualizations Panel -->
        <div class="panel visualization-panel">
            <h2>üìà Training Visualizations</h2>
            <div class="viz-tabs">
                <button class="viz-tab active" data-tab="rewards">Reward Progress</button>
                <button class="viz-tab" data-tab="actions">Action Performance</button>
                <button class="viz-tab" data-tab="decisions">LLM Decisions</button>
                <button class="viz-tab" data-tab="exploration">Exploration Map</button>
            </div>

            <div class="viz-content">
                <div id="rewards-viz" class="viz-panel active">
                    <canvas id="rewards-chart" width="400" height="200"></canvas>
                    <div class="viz-legend">
                        <span class="legend-item"><span class="legend-color" style="background: #4CAF50"></span>Cumulative Reward</span>
                        <span class="legend-item"><span class="legend-color" style="background: #2196F3"></span>Recent Rewards</span>
                    </div>
                </div>

                <div id="actions-viz" class="viz-panel">
                    <canvas id="actions-heatmap" width="400" height="200"></canvas>
                    <div class="action-stats" id="action-stats">
                        <div class="stat-row">
                            <span>Most Used Action:</span>
                            <span id="most-used-action">-</span>
                        </div>
                        <div class="stat-row">
                            <span>Success Rate:</span>
                            <span id="avg-success-rate">-</span>
                        </div>
                    </div>
                </div>

                <div id="decisions-viz" class="viz-panel">
                    <div class="decision-flow" id="decision-flow">
                        <div class="flow-item">Loading decision patterns...</div>
                    </div>
                </div>

                <div id="exploration-viz" class="viz-panel">
                    <canvas id="exploration-heatmap" width="400" height="200"></canvas>
                    <div class="exploration-stats">
                        <span>Coverage: <span id="exploration-coverage">0%</span></span>
                        <span>Current Map: <span id="current-map">0</span></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Display -->
    <div id="error-banner" class="error-banner hidden">
        <div class="error-content">
            <span id="error-message">Connection error</span>
            <button id="dismiss-error" class="error-dismiss">√ó</button>
        </div>
    </div>

    <!-- Performance Monitor (optional debug info) -->
    <div id="performance-monitor" class="performance-monitor">
        <div class="perf-item">
            <span>Updates/sec:</span>
            <span id="update-rate">0</span>
        </div>
        <div class="perf-item">
            <span>Latency:</span>
            <span id="latency">0ms</span>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>